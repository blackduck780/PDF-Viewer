<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jio PDF Reader - Offline Dark Mode</title>
  <link rel="stylesheet" href="pdfjs/web/viewer.css?dark=1">
  <style>
    /* Custom dark theme overrides for low-light JioPhone use */
    body { background: #121212; color: #e0e0e0; }
    #viewerContainer { background: #1e1e1e; }
    .toolbar { background: #1e1e1e !important; }
    /* Toggle button */
    #themeToggle { position: fixed; top: 10px; right: 10px; z-index: 1000; background: #333; color: white; border: none; padding: 10px; cursor: pointer; }
    /* Mobile optimizations */
    @media (max-width: 480px) { #viewerContainer { overflow: auto; } }
  </style>
</head>
<body>
  <button id="themeToggle" onclick="toggleDark()">üåô Dark</button>
  <input type="file" id="pdfFile" accept=".pdf" style="position: fixed; top: 50px; right: 10px; z-index: 1000;">
  <iframe id="pdfViewer" src="pdfjs/web/viewer.html" width="100%" height="100%" style="border: none;"></iframe>

  <script src="pdfjs/build/pdf.js"></script>
  <script>
    // Register service worker for offline (caches PDF.js + uploaded PDFs via IndexedDB fallback)
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js');
    }
    // File upload handler
    document.getElementById('pdfFile').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        const url = URL.createObjectURL(file);
        document.getElementById('pdfViewer').src = `pdfjs/web/viewer.html?file=${encodeURIComponent(url)}`;
      }
    });
    // Dark theme toggle (PDF.js supports via CSS theme param)
    function toggleDark() {
      const iframe = document.getElementById('pdfViewer');
      const isDark = iframe.src.includes('dark=2');
      iframe.src = iframe.src.replace('dark=2', 'dark=0').replace('dark=1', 'dark=2') || iframe.src + (isDark ? '' : '?dark=2');
      document.getElementById('themeToggle').textContent = isDark ? '‚òÄÔ∏è Light' : 'üåô Dark';
    }
    // Force dark on load for JioPhone
    document.getElementById('pdfViewer').src += '?viewerCssTheme=2';  // 2=dark[web:26][web:12]
  </script>
</body>
</html>
